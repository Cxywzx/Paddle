Hit Cache !!!! cache pool index is 0, var name is sequence_pool_0.tmp_0@GRAD, cached var name is sequence_pool_0.tmp_0, var shape is [-1L, 32L] 
Hit Cache !!!! cache pool index is 14, var name is fc_0.tmp_1@GRAD, cached var name is lstm_0.tmp_2, var shape is [-1L, 128L] 
Hit Cache !!!! cache pool index is 20, var name is fc_0.tmp_0@GRAD, cached var name is fc_0.tmp_2, var shape is [-1L, 128L] 
Hit Cache !!!! cache pool index is 11, var name is embedding_0.tmp_0@GRAD, cached var name is embedding_1.tmp_0, var shape is [-1L, 16L] 
blocks {
  idx: 0
  parent_idx: -1
  vars {
    name: "lstm_0.tmp_2@GRAD"
    type: LOD_TENSOR
  }
  vars {
    name: "lstm_0.tmp_1@GRAD"
    type: LOD_TENSOR
  }
  vars {
    name: "@EMPTY@"
    type: LOD_TENSOR
  }
  vars {
    name: "learning_rate_6"
    type: LOD_TENSOR
    lod_tensor {
      tensor {
        data_type: FP32
        dims: 1
      }
      lod_level: 1
    }
    persistable: true
  }
  vars {
    name: "learning_rate_5"
    type: LOD_TENSOR
    lod_tensor {
      tensor {
        data_type: FP32
        dims: 1
      }
      lod_level: 1
    }
    persistable: true
  }
  vars {
    name: "learning_rate_4"
    type: LOD_TENSOR
    lod_tensor {
      tensor {
        data_type: FP32
        dims: 1
      }
      lod_level: 1
    }
    persistable: true
  }
  vars {
    name: "learning_rate_3"
    type: LOD_TENSOR
    lod_tensor {
      tensor {
        data_type: FP32
        dims: 1
      }
      lod_level: 1
    }
    persistable: true
  }
  vars {
    name: "moment_9"
    type: LOD_TENSOR
    lod_tensor {
      tensor {
        data_type: FP32
        dims: 16
        dims: 32
      }
    }
    persistable: true
  }
  vars {
    name: "moment_7"
    type: LOD_TENSOR
    lod_tensor {
      tensor {
        data_type: FP32
        dims: 1
        dims: 224
      }
    }
    persistable: true
  }
  vars {
    name: "moment_3"
    type: LOD_TENSOR
    lod_tensor {
      tensor {
        data_type: FP32
        dims: 128
      }
    }
    persistable: true
  }
  vars {
    name: "moment_1"
    type: LOD_TENSOR
    lod_tensor {
      tensor {
        data_type: FP32
        dims: 30000
      }
    }
    persistable: true
  }
  vars {
    name: "vemb@GRAD"
    type: SELECTED_ROWS
    selected_rows {
      data_type: FP32
      dims: 30000
      dims: 16
    }
  }
  vars {
    name: "vemb@GRAD@RENAME@1"
    type: SELECTED_ROWS
    selected_rows {
      data_type: FP32
      dims: 30000
      dims: 16
    }
  }
  vars {
    name: "learning_rate_9"
    type: LOD_TENSOR
    lod_tensor {
      tensor {
        data_type: FP32
        dims: 1
      }
      lod_level: 1
    }
    persistable: true
  }
  vars {
    name: "embedding_0.tmp_0@GRAD"
    type: LOD_TENSOR
    lod_tensor {
      tensor {
        data_type: FP32
        dims: -1
        dims: 16
      }
    }
  }
  vars {
    name: "learning_rate_1"
    type: LOD_TENSOR
    lod_tensor {
      tensor {
        data_type: FP32
        dims: 1
      }
      lod_level: 1
    }
    persistable: true
  }
  vars {
    name: "fc_0.b_0@GRAD"
    type: LOD_TENSOR
    lod_tensor {
      tensor {
        data_type: FP32
        dims: 128
      }
    }
  }
  vars {
    name: "moment_0"
    type: LOD_TENSOR
    lod_tensor {
      tensor {
        data_type: FP32
        dims: 32
      }
    }
    persistable: true
  }
  vars {
    name: "lstm_0.w_0@GRAD"
    type: LOD_TENSOR
    lod_tensor {
      tensor {
        data_type: FP32
        dims: 32
        dims: 128
      }
    }
  }
  vars {
    name: "lstm_0.b_0@GRAD"
    type: LOD_TENSOR
    lod_tensor {
      tensor {
        data_type: FP32
        dims: 1
        dims: 224
      }
    }
  }
  vars {
    name: "lstm_0.tmp_0@GRAD"
    type: LOD_TENSOR
    lod_tensor {
      tensor {
        data_type: FP32
        dims: -1
        dims: 32
      }
      lod_level: 1
    }
  }
  vars {
    name: "learning_rate_8"
    type: LOD_TENSOR
    lod_tensor {
      tensor {
        data_type: FP32
        dims: 1
      }
      lod_level: 1
    }
    persistable: true
  }
  vars {
    name: "sequence_pool_0.tmp_0@GRAD"
    type: LOD_TENSOR
    lod_tensor {
      tensor {
        data_type: FP32
        dims: -1
        dims: 32
      }
    }
  }
  vars {
    name: "dynamic_rnn_mem_array_0@GRAD"
    type: LOD_TENSOR_ARRAY
    tensor_array {
      tensor {
        data_type: FP32
        dims: -1
        dims: 32
      }
    }
  }
  vars {
    name: "lstm_0.tmp_0"
    type: LOD_TENSOR
    lod_tensor {
      tensor {
        data_type: FP32
        dims: -1
        dims: 32
      }
      lod_level: 1
    }
    persistable: false
  }
  vars {
    name: "dynamic_rnn_0_output_array_fc_2.tmp_2_0"
    type: LOD_TENSOR_ARRAY
    tensor_array {
      tensor {
        data_type: FP32
        dims: -1
        dims: 30000
      }
    }
  }
  vars {
    name: "cross_entropy_0.tmp_0"
    type: LOD_TENSOR
    lod_tensor {
      tensor {
        data_type: FP32
        dims: -1
        dims: 1
      }
      lod_level: 0
    }
    persistable: false
  }
  vars {
    name: "fc_1.w_1@GRAD"
    type: LOD_TENSOR
    lod_tensor {
      tensor {
        data_type: FP32
        dims: 32
        dims: 32
      }
    }
  }
  vars {
    name: "array_to_lod_tensor_0.tmp_0@GRAD"
    type: LOD_TENSOR
    lod_tensor {
      tensor {
        data_type: FP32
        dims: -1
        dims: 30000
      }
      lod_level: 0
    }
  }
  vars {
    name: "moment_6"
    type: LOD_TENSOR
    lod_tensor {
      tensor {
        data_type: FP32
        dims: 30000
        dims: 16
      }
    }
    persistable: true
  }
  vars {
    name: "cross_entropy_0.tmp_0@GRAD"
    type: LOD_TENSOR
    lod_tensor {
      tensor {
        data_type: FP32
        dims: -1
        dims: 1
      }
      lod_level: 0
    }
  }
  vars {
    name: "fill_constant_0.tmp_0"
    type: LOD_TENSOR
    lod_tensor {
      tensor {
        data_type: INT64
        dims: 1
      }
    }
    persistable: false
  }
  vars {
    name: "mean_0.tmp_0@GRAD"
    type: LOD_TENSOR
    lod_tensor {
      tensor {
        data_type: FP32
        dims: 1
      }
    }
  }
  vars {
    name: "mean_0.tmp_0"
    type: LOD_TENSOR
    lod_tensor {
      tensor {
        data_type: FP32
        dims: 1
      }
    }
    persistable: false
  }
  vars {
    name: "fc_0.tmp_2@GRAD"
    type: LOD_TENSOR
    lod_tensor {
      tensor {
        data_type: FP32
        dims: -1
        dims: 128
      }
    }
  }
  vars {
    name: "target_language_next_word"
    type: LOD_TENSOR
    lod_tensor {
      tensor {
        data_type: INT64
        dims: -1
        dims: 1
      }
      lod_level: 1
    }
    persistable: false
  }
  vars {
    name: "fc_0.tmp_0@GRAD"
    type: LOD_TENSOR
    lod_tensor {
      tensor {
        data_type: FP32
        dims: -1
        dims: 128
      }
    }
  }
  vars {
    name: "fc_1.b_0@GRAD"
    type: LOD_TENSOR
    lod_tensor {
      tensor {
        data_type: FP32
        dims: 32
      }
    }
  }
  vars {
    name: "array_to_lod_tensor_0.tmp_0"
    type: LOD_TENSOR
    lod_tensor {
      tensor {
        data_type: FP32
        dims: -1
        dims: 30000
      }
    }
    persistable: false
  }
  vars {
    name: "dynamic_rnn_0_output_array_fc_2.tmp_2_0@GRAD"
    type: LOD_TENSOR_ARRAY
    tensor_array {
      tensor {
        data_type: FP32
        dims: -1
        dims: 30000
      }
    }
  }
  vars {
    name: "_generated_var_0"
    type: STEP_SCOPES
  }
  vars {
    name: "fc_1.w_0@GRAD"
    type: LOD_TENSOR
    lod_tensor {
      tensor {
        data_type: FP32
        dims: 16
        dims: 32
      }
    }
  }
  vars {
    name: "fc_0.w_0@GRAD"
    type: LOD_TENSOR
    lod_tensor {
      tensor {
        data_type: FP32
        dims: 16
        dims: 128
      }
    }
  }
  vars {
    name: "fc_0.tmp_1@GRAD"
    type: LOD_TENSOR
    lod_tensor {
      tensor {
        data_type: FP32
        dims: -1
        dims: 128
      }
    }
  }
  vars {
    name: "fc_0.b_0"
    type: LOD_TENSOR
    lod_tensor {
      tensor {
        data_type: FP32
        dims: 128
      }
    }
    persistable: true
  }
  vars {
    name: "fc_2.b_0"
    type: LOD_TENSOR
    lod_tensor {
      tensor {
        data_type: FP32
        dims: 30000
      }
    }
    persistable: true
  }
  vars {
    name: "fc_2.w_0"
    type: LOD_TENSOR
    lod_tensor {
      tensor {
        data_type: FP32
        dims: 32
        dims: 30000
      }
    }
    persistable: true
  }
  vars {
    name: "fc_1.b_0"
    type: LOD_TENSOR
    lod_tensor {
      tensor {
        data_type: FP32
        dims: 32
      }
    }
    persistable: true
  }
  vars {
    name: "lstm_0.tmp_3@GRAD"
    type: LOD_TENSOR
  }
  vars {
    name: "fc_1.w_0"
    type: LOD_TENSOR
    lod_tensor {
      tensor {
        data_type: FP32
        dims: 16
        dims: 32
      }
    }
    persistable: true
  }
  vars {
    name: "fc_1.w_1"
    type: LOD_TENSOR
    lod_tensor {
      tensor {
        data_type: FP32
        dims: 32
        dims: 32
      }
    }
    persistable: true
  }
  vars {
    name: "dynamic_rnn_mem_array_0"
    type: LOD_TENSOR_ARRAY
    tensor_array {
      tensor {
        data_type: FP32
        dims: -1
        dims: 32
      }
    }
  }
  vars {
    name: "fc_0.tmp_2"
    type: LOD_TENSOR
    lod_tensor {
      tensor {
        data_type: FP32
        dims: -1
        dims: 128
      }
      lod_level: 1
    }
    persistable: false
  }
  vars {
    name: "moment_8"
    type: LOD_TENSOR
    lod_tensor {
      tensor {
        data_type: FP32
        dims: 32
        dims: 32
      }
    }
    persistable: true
  }
  vars {
    name: "lstm_0.tmp_3"
    type: LOD_TENSOR
    lod_tensor {
      tensor {
        data_type: FP32
        dims: -1
        dims: 32
      }
    }
    persistable: false
  }
  vars {
    name: "dynamic_rnn_max_seq_len_0"
    type: LOD_TENSOR
    lod_tensor {
      tensor {
        data_type: INT64
        dims: 1
      }
    }
  }
  vars {
    name: "fc_0.w_0"
    type: LOD_TENSOR
    lod_tensor {
      tensor {
        data_type: FP32
        dims: 16
        dims: 128
      }
    }
    persistable: true
  }
  vars {
    name: "dynamic_rnn_0.tmp_0"
    type: LOD_TENSOR
    lod_tensor {
      tensor {
        data_type: BOOL
        dims: 1
      }
      lod_level: 0
    }
    persistable: false
  }
  vars {
    name: "vemb"
    type: LOD_TENSOR
    lod_tensor {
      tensor {
        data_type: FP32
        dims: 30000
        dims: 16
      }
    }
    persistable: true
  }
  vars {
    name: "embedding_1.tmp_0"
    type: LOD_TENSOR
    lod_tensor {
      tensor {
        data_type: FP32
        dims: -1
        dims: 16
      }
      lod_level: 1
    }
    persistable: false
  }
  vars {
    name: "learning_rate_7"
    type: LOD_TENSOR
    lod_tensor {
      tensor {
        data_type: FP32
        dims: 1
      }
      lod_level: 1
    }
    persistable: true
  }
  vars {
    name: "moment_5"
    type: LOD_TENSOR
    lod_tensor {
      tensor {
        data_type: FP32
        dims: 16
        dims: 128
      }
    }
    persistable: true
  }
  vars {
    name: "target_language_word"
    type: LOD_TENSOR
    lod_tensor {
      tensor {
        data_type: INT64
        dims: -1
        dims: 1
      }
      lod_level: 1
    }
    persistable: false
  }
  vars {
    name: "sequence_pool_0.tmp_1"
    type: LOD_TENSOR
    lod_tensor {
      tensor {
        data_type: FP32
      }
    }
    persistable: false
  }
  vars {
    name: "learning_rate_2"
    type: LOD_TENSOR
    lod_tensor {
      tensor {
        data_type: FP32
        dims: 1
      }
      lod_level: 1
    }
    persistable: true
  }
  vars {
    name: "moment_4"
    type: LOD_TENSOR
    lod_tensor {
      tensor {
        data_type: FP32
        dims: 32
        dims: 30000
      }
    }
    persistable: true
  }
  vars {
    name: "moment_2"
    type: LOD_TENSOR
    lod_tensor {
      tensor {
        data_type: FP32
        dims: 32
        dims: 128
      }
    }
    persistable: true
  }
  vars {
    name: "vemb@GRAD@RENAME@0"
    type: SELECTED_ROWS
    selected_rows {
      data_type: FP32
      dims: 30000
      dims: 16
    }
  }
  vars {
    name: "fc_2.b_0@GRAD"
    type: LOD_TENSOR
    lod_tensor {
      tensor {
        data_type: FP32
        dims: 30000
      }
    }
  }
  vars {
    name: "lod_rank_table_0"
    type: LOD_RANK_TABLE
  }
  vars {
    name: "sequence_pool_0.tmp_0"
    type: LOD_TENSOR
    lod_tensor {
      tensor {
        data_type: FP32
        dims: -1
        dims: 32
      }
    }
    persistable: false
  }
  vars {
    name: "fc_2.w_0@GRAD"
    type: LOD_TENSOR
    lod_tensor {
      tensor {
        data_type: FP32
        dims: 32
        dims: 30000
      }
    }
  }
  vars {
    name: "embedding_1.tmp_0@GRAD"
    type: LOD_TENSOR
    lod_tensor {
      tensor {
        data_type: FP32
        dims: -1
        dims: 16
      }
    }
  }
  vars {
    name: "dynamic_rnn_input_array_0@GRAD"
    type: LOD_TENSOR_ARRAY
    tensor_array {
      tensor {
        data_type: FP32
        dims: -1
        dims: 16
      }
    }
  }
  vars {
    name: "lstm_0.tmp_1"
    type: LOD_TENSOR
    lod_tensor {
      tensor {
        data_type: FP32
        dims: -1
        dims: 32
      }
      lod_level: 1
    }
    persistable: false
  }
  vars {
    name: "learning_rate_0"
    type: LOD_TENSOR
    lod_tensor {
      tensor {
        data_type: FP32
        dims: 1
      }
      lod_level: 1
    }
    persistable: true
  }
  vars {
    name: "fill_constant_1.tmp_0"
    type: LOD_TENSOR
    lod_tensor {
      tensor {
        data_type: INT64
        dims: 1
      }
    }
    persistable: false
  }
  vars {
    name: "lstm_0.b_0"
    type: LOD_TENSOR
    lod_tensor {
      tensor {
        data_type: FP32
        dims: 1
        dims: 224
      }
    }
    persistable: true
  }
  vars {
    name: "lstm_0.w_0"
    type: LOD_TENSOR
    lod_tensor {
      tensor {
        data_type: FP32
        dims: 32
        dims: 128
      }
    }
    persistable: true
  }
  vars {
    name: "dynamic_rnn_input_array_0"
    type: LOD_TENSOR_ARRAY
    tensor_array {
      tensor {
        data_type: FP32
        dims: -1
        dims: 16
      }
    }
  }
  vars {
    name: "fc_0.tmp_1"
    type: LOD_TENSOR
    lod_tensor {
      tensor {
        data_type: FP32
        dims: -1
        dims: 128
      }
      lod_level: 1
    }
    persistable: false
  }
  vars {
    name: "fc_0.tmp_0"
    type: LOD_TENSOR
    lod_tensor {
      tensor {
        data_type: FP32
        dims: -1
        dims: 128
      }
      lod_level: 1
    }
    persistable: false
  }
  vars {
    name: "embedding_0.tmp_0"
    type: LOD_TENSOR
    lod_tensor {
      tensor {
        data_type: FP32
        dims: -1
        dims: 16
      }
      lod_level: 1
    }
    persistable: false
  }
  vars {
    name: "lstm_0.tmp_2"
    type: LOD_TENSOR
    lod_tensor {
      tensor {
        data_type: FP32
        dims: -1
        dims: 128
      }
    }
    persistable: false
  }
  vars {
    name: "src_word_id"
    type: LOD_TENSOR
    lod_tensor {
      tensor {
        data_type: INT64
        dims: -1
        dims: 1
      }
      lod_level: 1
    }
    persistable: false
  }
  ops {
    inputs {
      parameter: "Ids"
      arguments: "src_word_id"
    }
    inputs {
      parameter: "W"
      arguments: "vemb"
    }
    outputs {
      parameter: "Out"
      arguments: "embedding_0.tmp_0"
    }
    type: "lookup_table"
    attrs {
      name: "is_sparse"
      type: BOOLEAN
      b: true
    }
  }
  ops {
    inputs {
      parameter: "X"
      arguments: "embedding_0.tmp_0"
    }
    inputs {
      parameter: "Y"
      arguments: "fc_0.w_0"
    }
    outputs {
      parameter: "Out"
      arguments: "fc_0.tmp_0"
    }
    type: "mul"
    attrs {
      name: "y_num_col_dims"
      type: INT
      i: 1
    }
    attrs {
      name: "x_num_col_dims"
      type: INT
      i: 1
    }
  }
  ops {
    inputs {
      parameter: "X"
      arguments: "fc_0.tmp_0"
    }
    inputs {
      parameter: "Y"
      arguments: "fc_0.b_0"
    }
    outputs {
      parameter: "Out"
      arguments: "fc_0.tmp_1"
    }
    type: "elementwise_add"
    attrs {
      name: "axis"
      type: INT
      i: 1
    }
  }
  ops {
    inputs {
      parameter: "X"
      arguments: "fc_0.tmp_1"
    }
    outputs {
      parameter: "Out"
      arguments: "fc_0.tmp_2"
    }
    type: "tanh"
  }
  ops {
    inputs {
      parameter: "Bias"
      arguments: "lstm_0.b_0"
    }
    inputs {
      parameter: "C0"
    }
    inputs {
      parameter: "H0"
    }
    inputs {
      parameter: "Input"
      arguments: "fc_0.tmp_2"
    }
    inputs {
      parameter: "Weight"
      arguments: "lstm_0.w_0"
    }
    outputs {
      parameter: "BatchCellPreAct"
      arguments: "lstm_0.tmp_3"
    }
    outputs {
      parameter: "BatchGate"
      arguments: "lstm_0.tmp_2"
    }
    outputs {
      parameter: "Cell"
      arguments: "lstm_0.tmp_1"
    }
    outputs {
      parameter: "Hidden"
      arguments: "lstm_0.tmp_0"
    }
    type: "lstm"
    attrs {
      name: "candidate_activation"
      type: STRING
      s: "tanh"
    }
    attrs {
      name: "cell_activation"
      type: STRING
      s: "tanh"
    }
    attrs {
      name: "gate_activation"
      type: STRING
      s: "sigmoid"
    }
    attrs {
      name: "is_reverse"
      type: BOOLEAN
      b: false
    }
    attrs {
      name: "use_peepholes"
      type: BOOLEAN
      b: true
    }
  }
  ops {
    inputs {
      parameter: "X"
      arguments: "lstm_0.tmp_0"
    }
    outputs {
      parameter: "MaxIndex"
      arguments: "sequence_pool_0.tmp_1"
    }
    outputs {
      parameter: "Out"
      arguments: "sequence_pool_0.tmp_0"
    }
    type: "sequence_pool"
    attrs {
      name: "pooltype"
      type: STRING
      s: "LAST"
    }
  }
  ops {
    inputs {
      parameter: "Ids"
      arguments: "target_language_word"
    }
    inputs {
      parameter: "W"
      arguments: "vemb"
    }
    outputs {
      parameter: "Out"
      arguments: "embedding_1.tmp_0"
    }
    type: "lookup_table"
    attrs {
      name: "is_sparse"
      type: BOOLEAN
      b: true
    }
  }
  ops {
    outputs {
      parameter: "Out"
      arguments: "fill_constant_0.tmp_0"
    }
    type: "fill_constant"
    attrs {
      name: "force_cpu"
      type: BOOLEAN
      b: false
    }
    attrs {
      name: "value"
      type: FLOAT
      f: 0.0
    }
    attrs {
      name: "shape"
      type: INTS
      ints: 1
    }
    attrs {
      name: "dtype"
      type: INT
      i: 3
    }
  }
  ops {
    outputs {
      parameter: "Out"
      arguments: "fill_constant_1.tmp_0"
    }
    type: "fill_constant"
    attrs {
      name: "force_cpu"
      type: BOOLEAN
      b: false
    }
    attrs {
      name: "value"
      type: FLOAT
      f: 0.0
    }
    attrs {
      name: "shape"
      type: INTS
      ints: 1
    }
    attrs {
      name: "dtype"
      type: INT
      i: 3
    }
  }
  ops {
    inputs {
      parameter: "X"
      arguments: "embedding_1.tmp_0"
    }
    outputs {
      parameter: "Out"
      arguments: "lod_rank_table_0"
    }
    type: "lod_rank_table"
    attrs {
      name: "level"
      type: INT
      i: 0
    }
  }
  ops {
    inputs {
      parameter: "RankTable"
      arguments: "lod_rank_table_0"
    }
    outputs {
      parameter: "Out"
      arguments: "dynamic_rnn_max_seq_len_0"
    }
    type: "max_sequence_len"
  }
  ops {
    inputs {
      parameter: "X"
      arguments: "fill_constant_1.tmp_0"
    }
    inputs {
      parameter: "Y"
      arguments: "dynamic_rnn_max_seq_len_0"
    }
    outputs {
      parameter: "Out"
      arguments: "dynamic_rnn_0.tmp_0"
    }
    type: "less_than"
  }
  ops {
    inputs {
      parameter: "RankTable"
      arguments: "lod_rank_table_0"
    }
    inputs {
      parameter: "X"
      arguments: "embedding_1.tmp_0"
    }
    outputs {
      parameter: "Out"
      arguments: "dynamic_rnn_input_array_0"
    }
    type: "lod_tensor_to_array"
  }
  ops {
    inputs {
      parameter: "I"
      arguments: "fill_constant_0.tmp_0"
    }
    inputs {
      parameter: "X"
      arguments: "sequence_pool_0.tmp_0"
    }
    outputs {
      parameter: "Out"
      arguments: "dynamic_rnn_mem_array_0"
    }
    type: "write_to_array"
  }
  ops {
    inputs {
      parameter: "Condition"
      arguments: "dynamic_rnn_0.tmp_0"
    }
    inputs {
      parameter: "X"
      arguments: "fc_1.w_1"
      arguments: "fc_1.w_0"
      arguments: "fill_constant_1.tmp_0"
      arguments: "dynamic_rnn_input_array_0"
      arguments: "fc_2.w_0"
      arguments: "dynamic_rnn_mem_array_0"
      arguments: "dynamic_rnn_max_seq_len_0"
      arguments: "fc_1.b_0"
      arguments: "lod_rank_table_0"
      arguments: "fc_2.b_0"
    }
    outputs {
      parameter: "Out"
      arguments: "fill_constant_1.tmp_0"
      arguments: "dynamic_rnn_0_output_array_fc_2.tmp_2_0"
      arguments: "dynamic_rnn_mem_array_0"
      arguments: "dynamic_rnn_0.tmp_0"
    }
    outputs {
      parameter: "StepScopes"
      arguments: "_generated_var_0"
    }
    type: "while"
    attrs {
      name: "sub_block"
      type: BLOCK
      block_idx: 1
    }
  }
  ops {
    inputs {
      parameter: "RankTable"
      arguments: "lod_rank_table_0"
    }
    inputs {
      parameter: "X"
      arguments: "dynamic_rnn_0_output_array_fc_2.tmp_2_0"
    }
    outputs {
      parameter: "Out"
      arguments: "array_to_lod_tensor_0.tmp_0"
    }
    type: "array_to_lod_tensor"
  }
  ops {
    inputs {
      parameter: "Label"
      arguments: "target_language_next_word"
    }
    inputs {
      parameter: "X"
      arguments: "array_to_lod_tensor_0.tmp_0"
    }
    outputs {
      parameter: "Y"
      arguments: "cross_entropy_0.tmp_0"
    }
    type: "cross_entropy"
    attrs {
      name: "soft_label"
      type: BOOLEAN
      b: false
    }
  }
  ops {
    inputs {
      parameter: "X"
      arguments: "cross_entropy_0.tmp_0"
    }
    outputs {
      parameter: "Out"
      arguments: "mean_0.tmp_0"
    }
    type: "mean"
  }
  ops {
    outputs {
      parameter: "Out"
      arguments: "mean_0.tmp_0@GRAD"
    }
    type: "fill_constant"
    attrs {
      name: "dtype"
      type: INT
      i: 5
    }
    attrs {
      name: "shape"
      type: INTS
      ints: 1
    }
    attrs {
      name: "value"
      type: FLOAT
      f: 1.0
    }
  }
  ops {
    inputs {
      parameter: "Out@GRAD"
      arguments: "mean_0.tmp_0@GRAD"
    }
    inputs {
      parameter: "X"
      arguments: "cross_entropy_0.tmp_0"
    }
    outputs {
      parameter: "X@GRAD"
      arguments: "cross_entropy_0.tmp_0@GRAD"
    }
    type: "mean_grad"
  }
  ops {
    inputs {
      parameter: "Label"
      arguments: "target_language_next_word"
    }
    inputs {
      parameter: "X"
      arguments: "array_to_lod_tensor_0.tmp_0"
    }
    inputs {
      parameter: "Y"
      arguments: "cross_entropy_0.tmp_0"
    }
    inputs {
      parameter: "Y@GRAD"
      arguments: "cross_entropy_0.tmp_0@GRAD"
    }
    outputs {
      parameter: "Label@GRAD"
    }
    outputs {
      parameter: "X@GRAD"
      arguments: "array_to_lod_tensor_0.tmp_0@GRAD"
    }
    type: "cross_entropy_grad"
    attrs {
      name: "soft_label"
      type: BOOLEAN
      b: false
    }
  }
  ops {
    inputs {
      parameter: "RankTable"
      arguments: "lod_rank_table_0"
    }
    inputs {
      parameter: "X"
      arguments: "array_to_lod_tensor_0.tmp_0@GRAD"
    }
    outputs {
      parameter: "Out"
      arguments: "dynamic_rnn_0_output_array_fc_2.tmp_2_0@GRAD"
    }
    type: "lod_tensor_to_array"
  }
  ops {
    inputs {
      parameter: "Out"
      arguments: "fill_constant_1.tmp_0"
      arguments: "dynamic_rnn_0_output_array_fc_2.tmp_2_0"
      arguments: "dynamic_rnn_mem_array_0"
      arguments: "dynamic_rnn_0.tmp_0"
    }
    inputs {
      parameter: "Out@GRAD"
      arguments: "dynamic_rnn_0_output_array_fc_2.tmp_2_0@GRAD"
      arguments: "dynamic_rnn_mem_array_0@GRAD"
    }
    inputs {
      parameter: "StepScopes"
      arguments: "_generated_var_0"
    }
    inputs {
      parameter: "X"
      arguments: "fc_1.w_1"
      arguments: "fc_1.w_0"
      arguments: "fill_constant_1.tmp_0"
      arguments: "dynamic_rnn_input_array_0"
      arguments: "fc_2.w_0"
      arguments: "dynamic_rnn_mem_array_0"
      arguments: "dynamic_rnn_max_seq_len_0"
      arguments: "fc_1.b_0"
      arguments: "lod_rank_table_0"
      arguments: "fc_2.b_0"
    }
    outputs {
      parameter: "X@GRAD"
      arguments: "fc_1.w_1@GRAD"
      arguments: "fc_1.w_0@GRAD"
      arguments: "@EMPTY@"
      arguments: "dynamic_rnn_input_array_0@GRAD"
      arguments: "fc_2.w_0@GRAD"
      arguments: "dynamic_rnn_mem_array_0@GRAD"
      arguments: "@EMPTY@"
      arguments: "fc_1.b_0@GRAD"
      arguments: "@EMPTY@"
      arguments: "fc_2.b_0@GRAD"
    }
    type: "while_grad"
    attrs {
      name: "sub_block"
      type: BLOCK
      block_idx: 2
    }
    attrs {
      name: "original_output_grad"
      type: STRINGS
      strings: "dynamic_rnn_0_output_array_fc_2.tmp_2_0@GRAD"
      strings: "dynamic_rnn_mem_array_0@GRAD"
    }
  }
  ops {
    inputs {
      parameter: "I"
      arguments: "fill_constant_0.tmp_0"
    }
    inputs {
      parameter: "X"
      arguments: "dynamic_rnn_mem_array_0@GRAD"
    }
    outputs {
      parameter: "Out"
      arguments: "sequence_pool_0.tmp_0"
    }
    type: "read_from_array"
  }
  ops {
    inputs {
      parameter: "RankTable"
      arguments: "lod_rank_table_0"
    }
    inputs {
      parameter: "X"
      arguments: "dynamic_rnn_input_array_0@GRAD"
    }
    outputs {
      parameter: "Out"
      arguments: "embedding_1.tmp_0@GRAD"
    }
    type: "array_to_lod_tensor"
  }
  ops {
    inputs {
      parameter: "Ids"
      arguments: "target_language_word"
    }
    inputs {
      parameter: "Out"
      arguments: "embedding_1.tmp_0"
    }
    inputs {
      parameter: "Out@GRAD"
      arguments: "embedding_1.tmp_0@GRAD"
    }
    inputs {
      parameter: "W"
      arguments: "vemb"
    }
    outputs {
      parameter: "Ids@GRAD"
    }
    outputs {
      parameter: "W@GRAD"
      arguments: "vemb@GRAD@RENAME@0"
    }
    type: "lookup_table_grad"
    attrs {
      name: "is_sparse"
      type: BOOLEAN
      b: true
    }
  }
  ops {
    inputs {
      parameter: "Out@GRAD"
      arguments: "sequence_pool_0.tmp_0"
    }
    inputs {
      parameter: "X"
      arguments: "lstm_0.tmp_0"
    }
    outputs {
      parameter: "X@GRAD"
      arguments: "lstm_0.tmp_0@GRAD"
    }
    type: "sequence_pool_grad"
    attrs {
      name: "pooltype"
      type: STRING
      s: "LAST"
    }
  }
  ops {
    inputs {
      parameter: "BatchCellPreAct"
      arguments: "lstm_0.tmp_3"
    }
    inputs {
      parameter: "BatchCellPreAct@GRAD"
      arguments: "lstm_0.tmp_3@GRAD"
    }
    inputs {
      parameter: "BatchGate"
      arguments: "lstm_0.tmp_2"
    }
    inputs {
      parameter: "BatchGate@GRAD"
      arguments: "lstm_0.tmp_2@GRAD"
    }
    inputs {
      parameter: "Bias"
      arguments: "lstm_0.b_0"
    }
    inputs {
      parameter: "C0"
    }
    inputs {
      parameter: "Cell"
      arguments: "lstm_0.tmp_1"
    }
    inputs {
      parameter: "Cell@GRAD"
      arguments: "lstm_0.tmp_1@GRAD"
    }
    inputs {
      parameter: "H0"
    }
    inputs {
      parameter: "Hidden"
      arguments: "lstm_0.tmp_0"
    }
    inputs {
      parameter: "Hidden@GRAD"
      arguments: "lstm_0.tmp_0@GRAD"
    }
    inputs {
      parameter: "Input"
      arguments: "fc_0.tmp_2"
    }
    inputs {
      parameter: "Weight"
      arguments: "lstm_0.w_0"
    }
    outputs {
      parameter: "Bias@GRAD"
      arguments: "lstm_0.b_0@GRAD"
    }
    outputs {
      parameter: "C0@GRAD"
    }
    outputs {
      parameter: "H0@GRAD"
    }
    outputs {
      parameter: "Input@GRAD"
      arguments: "fc_0.tmp_2@GRAD"
    }
    outputs {
      parameter: "Weight@GRAD"
      arguments: "lstm_0.w_0@GRAD"
    }
    type: "lstm_grad"
    attrs {
      name: "candidate_activation"
      type: STRING
      s: "tanh"
    }
    attrs {
      name: "cell_activation"
      type: STRING
      s: "tanh"
    }
    attrs {
      name: "gate_activation"
      type: STRING
      s: "sigmoid"
    }
    attrs {
      name: "is_reverse"
      type: BOOLEAN
      b: false
    }
    attrs {
      name: "use_peepholes"
      type: BOOLEAN
      b: true
    }
  }
  ops {
    inputs {
      parameter: "Out"
      arguments: "fc_0.tmp_2"
    }
    inputs {
      parameter: "Out@GRAD"
      arguments: "fc_0.tmp_2@GRAD"
    }
    inputs {
      parameter: "X"
      arguments: "fc_0.tmp_1"
    }
    outputs {
      parameter: "X@GRAD"
      arguments: "lstm_0.tmp_2"
    }
    type: "tanh_grad"
  }
  ops {
    inputs {
      parameter: "Out"
      arguments: "fc_0.tmp_1"
    }
    inputs {
      parameter: "Out@GRAD"
      arguments: "lstm_0.tmp_2"
    }
    inputs {
      parameter: "X"
      arguments: "fc_0.tmp_0"
    }
    inputs {
      parameter: "Y"
      arguments: "fc_0.b_0"
    }
    outputs {
      parameter: "X@GRAD"
      arguments: "fc_0.tmp_2"
    }
    outputs {
      parameter: "Y@GRAD"
      arguments: "fc_0.b_0@GRAD"
    }
    type: "elementwise_add_grad"
    attrs {
      name: "axis"
      type: INT
      i: 1
    }
  }
  ops {
    inputs {
      parameter: "Out"
      arguments: "fc_0.tmp_0"
    }
    inputs {
      parameter: "Out@GRAD"
      arguments: "fc_0.tmp_2"
    }
    inputs {
      parameter: "X"
      arguments: "embedding_0.tmp_0"
    }
    inputs {
      parameter: "Y"
      arguments: "fc_0.w_0"
    }
    outputs {
      parameter: "X@GRAD"
      arguments: "embedding_1.tmp_0"
    }
    outputs {
      parameter: "Y@GRAD"
      arguments: "fc_0.w_0@GRAD"
    }
    type: "mul_grad"
    attrs {
      name: "y_num_col_dims"
      type: INT
      i: 1
    }
    attrs {
      name: "x_num_col_dims"
      type: INT
      i: 1
    }
  }
  ops {
    inputs {
      parameter: "Ids"
      arguments: "src_word_id"
    }
    inputs {
      parameter: "Out"
      arguments: "embedding_0.tmp_0"
    }
    inputs {
      parameter: "Out@GRAD"
      arguments: "embedding_1.tmp_0"
    }
    inputs {
      parameter: "W"
      arguments: "vemb"
    }
    outputs {
      parameter: "Ids@GRAD"
    }
    outputs {
      parameter: "W@GRAD"
      arguments: "vemb@GRAD@RENAME@1"
    }
    type: "lookup_table_grad"
    attrs {
      name: "is_sparse"
      type: BOOLEAN
      b: true
    }
  }
  ops {
    inputs {
      parameter: "X"
      arguments: "vemb@GRAD@RENAME@0"
      arguments: "vemb@GRAD@RENAME@1"
    }
    outputs {
      parameter: "Out"
      arguments: "vemb@GRAD"
    }
    type: "sum"
  }
  ops {
    inputs {
      parameter: "Grad"
      arguments: "fc_1.b_0@GRAD"
    }
    inputs {
      parameter: "LearningRate"
      arguments: "learning_rate_0"
    }
    inputs {
      parameter: "Moment"
      arguments: "moment_0"
    }
    inputs {
      parameter: "Param"
      arguments: "fc_1.b_0"
    }
    outputs {
      parameter: "MomentOut"
      arguments: "moment_0"
    }
    outputs {
      parameter: "ParamOut"
      arguments: "fc_1.b_0"
    }
    type: "adagrad"
    attrs {
      name: "epsilon"
      type: FLOAT
      f: 9.99999997475e-07
    }
  }
  ops {
    inputs {
      parameter: "Grad"
      arguments: "fc_2.b_0@GRAD"
    }
    inputs {
      parameter: "LearningRate"
      arguments: "learning_rate_1"
    }
    inputs {
      parameter: "Moment"
      arguments: "moment_1"
    }
    inputs {
      parameter: "Param"
      arguments: "fc_2.b_0"
    }
    outputs {
      parameter: "MomentOut"
      arguments: "moment_1"
    }
    outputs {
      parameter: "ParamOut"
      arguments: "fc_2.b_0"
    }
    type: "adagrad"
    attrs {
      name: "epsilon"
      type: FLOAT
      f: 9.99999997475e-07
    }
  }
  ops {
    inputs {
      parameter: "Grad"
      arguments: "lstm_0.w_0@GRAD"
    }
    inputs {
      parameter: "LearningRate"
      arguments: "learning_rate_2"
    }
    inputs {
      parameter: "Moment"
      arguments: "moment_2"
    }
    inputs {
      parameter: "Param"
      arguments: "lstm_0.w_0"
    }
    outputs {
      parameter: "MomentOut"
      arguments: "moment_2"
    }
    outputs {
      parameter: "ParamOut"
      arguments: "lstm_0.w_0"
    }
    type: "adagrad"
    attrs {
      name: "epsilon"
      type: FLOAT
      f: 9.99999997475e-07
    }
  }
  ops {
    inputs {
      parameter: "Grad"
      arguments: "fc_0.b_0@GRAD"
    }
    inputs {
      parameter: "LearningRate"
      arguments: "learning_rate_3"
    }
    inputs {
      parameter: "Moment"
      arguments: "moment_3"
    }
    inputs {
      parameter: "Param"
      arguments: "fc_0.b_0"
    }
    outputs {
      parameter: "MomentOut"
      arguments: "moment_3"
    }
    outputs {
      parameter: "ParamOut"
      arguments: "fc_0.b_0"
    }
    type: "adagrad"
    attrs {
      name: "epsilon"
      type: FLOAT
      f: 9.99999997475e-07
    }
  }
  ops {
    inputs {
      parameter: "Grad"
      arguments: "fc_2.w_0@GRAD"
    }
    inputs {
      parameter: "LearningRate"
      arguments: "learning_rate_4"
    }
    inputs {
      parameter: "Moment"
      arguments: "moment_4"
    }
    inputs {
      parameter: "Param"
      arguments: "fc_2.w_0"
    }
    outputs {
      parameter: "MomentOut"
      arguments: "moment_4"
    }
    outputs {
      parameter: "ParamOut"
      arguments: "fc_2.w_0"
    }
    type: "adagrad"
    attrs {
      name: "epsilon"
      type: FLOAT
      f: 9.99999997475e-07
    }
  }
  ops {
    inputs {
      parameter: "Grad"
      arguments: "fc_0.w_0@GRAD"
    }
    inputs {
      parameter: "LearningRate"
      arguments: "learning_rate_5"
    }
    inputs {
      parameter: "Moment"
      arguments: "moment_5"
    }
    inputs {
      parameter: "Param"
      arguments: "fc_0.w_0"
    }
    outputs {
      parameter: "MomentOut"
      arguments: "moment_5"
    }
    outputs {
      parameter: "ParamOut"
      arguments: "fc_0.w_0"
    }
    type: "adagrad"
    attrs {
      name: "epsilon"
      type: FLOAT
      f: 9.99999997475e-07
    }
  }
  ops {
    inputs {
      parameter: "Grad"
      arguments: "vemb@GRAD"
    }
    inputs {
      parameter: "LearningRate"
      arguments: "learning_rate_6"
    }
    inputs {
      parameter: "Moment"
      arguments: "moment_6"
    }
    inputs {
      parameter: "Param"
      arguments: "vemb"
    }
    outputs {
      parameter: "MomentOut"
      arguments: "moment_6"
    }
    outputs {
      parameter: "ParamOut"
      arguments: "vemb"
    }
    type: "adagrad"
    attrs {
      name: "epsilon"
      type: FLOAT
      f: 9.99999997475e-07
    }
  }
  ops {
    inputs {
      parameter: "Grad"
      arguments: "lstm_0.b_0@GRAD"
    }
    inputs {
      parameter: "LearningRate"
      arguments: "learning_rate_7"
    }
    inputs {
      parameter: "Moment"
      arguments: "moment_7"
    }
    inputs {
      parameter: "Param"
      arguments: "lstm_0.b_0"
    }
    outputs {
      parameter: "MomentOut"
      arguments: "moment_7"
    }
    outputs {
      parameter: "ParamOut"
      arguments: "lstm_0.b_0"
    }
    type: "adagrad"
    attrs {
      name: "epsilon"
      type: FLOAT
      f: 9.99999997475e-07
    }
  }
  ops {
    inputs {
      parameter: "Grad"
      arguments: "fc_1.w_1@GRAD"
    }
    inputs {
      parameter: "LearningRate"
      arguments: "learning_rate_8"
    }
    inputs {
      parameter: "Moment"
      arguments: "moment_8"
    }
    inputs {
      parameter: "Param"
      arguments: "fc_1.w_1"
    }
    outputs {
      parameter: "MomentOut"
      arguments: "moment_8"
    }
    outputs {
      parameter: "ParamOut"
      arguments: "fc_1.w_1"
    }
    type: "adagrad"
    attrs {
      name: "epsilon"
      type: FLOAT
      f: 9.99999997475e-07
    }
  }
  ops {
    inputs {
      parameter: "Grad"
      arguments: "fc_1.w_0@GRAD"
    }
    inputs {
      parameter: "LearningRate"
      arguments: "learning_rate_9"
    }
    inputs {
      parameter: "Moment"
      arguments: "moment_9"
    }
    inputs {
      parameter: "Param"
      arguments: "fc_1.w_0"
    }
    outputs {
      parameter: "MomentOut"
      arguments: "moment_9"
    }
    outputs {
      parameter: "ParamOut"
      arguments: "fc_1.w_0"
    }
    type: "adagrad"
    attrs {
      name: "epsilon"
      type: FLOAT
      f: 9.99999997475e-07
    }
  }
}
blocks {
  idx: 1
  parent_idx: 0
  vars {
    name: "fc_2.tmp_1"
    type: LOD_TENSOR
    lod_tensor {
      tensor {
        data_type: FP32
        dims: -1
        dims: 30000
      }
      lod_level: 0
    }
    persistable: false
  }
  vars {
    name: "fc_1.tmp_4"
    type: LOD_TENSOR
    lod_tensor {
      tensor {
        data_type: FP32
        dims: -1
        dims: 32
      }
      lod_level: 0
    }
    persistable: false
  }
  vars {
    name: "fc_1.tmp_3"
    type: LOD_TENSOR
    lod_tensor {
      tensor {
        data_type: FP32
        dims: -1
        dims: 32
      }
      lod_level: 0
    }
    persistable: false
  }
  vars {
    name: "fc_1.tmp_2"
    type: LOD_TENSOR
    lod_tensor {
      tensor {
        data_type: FP32
        dims: -1
        dims: 32
      }
      lod_level: 0
    }
    persistable: false
  }
  vars {
    name: "fc_1.tmp_0"
    type: LOD_TENSOR
    lod_tensor {
      tensor {
        data_type: FP32
        dims: -1
        dims: 32
      }
      lod_level: 0
    }
    persistable: false
  }
  vars {
    name: "fc_1.tmp_1"
    type: LOD_TENSOR
    lod_tensor {
      tensor {
        data_type: FP32
        dims: -1
        dims: 32
      }
      lod_level: 0
    }
    persistable: false
  }
  vars {
    name: "fc_2.tmp_0"
    type: LOD_TENSOR
    lod_tensor {
      tensor {
        data_type: FP32
        dims: -1
        dims: 30000
      }
      lod_level: 0
    }
    persistable: false
  }
  vars {
    name: "array_read_1.tmp_0"
    type: LOD_TENSOR
    lod_tensor {
      tensor {
        data_type: FP32
        dims: -1
        dims: 32
      }
    }
    persistable: false
  }
  vars {
    name: "shrink_memory_0.tmp_0"
    type: LOD_TENSOR
    lod_tensor {
      tensor {
        data_type: FP32
        dims: -1
        dims: 32
      }
    }
    persistable: false
  }
  vars {
    name: "fc_2.tmp_2"
    type: LOD_TENSOR
    lod_tensor {
      tensor {
        data_type: FP32
        dims: -1
        dims: 30000
      }
      lod_level: 0
    }
    persistable: false
  }
  vars {
    name: "array_read_0.tmp_0"
    type: LOD_TENSOR
    lod_tensor {
      tensor {
        data_type: FP32
        dims: -1
        dims: 16
      }
    }
    persistable: false
  }
  ops {
    inputs {
      parameter: "I"
      arguments: "fill_constant_1.tmp_0"
    }
    inputs {
      parameter: "X"
      arguments: "dynamic_rnn_input_array_0"
    }
    outputs {
      parameter: "Out"
      arguments: "array_read_0.tmp_0"
    }
    type: "read_from_array"
  }
  ops {
    inputs {
      parameter: "I"
      arguments: "fill_constant_1.tmp_0"
    }
    inputs {
      parameter: "X"
      arguments: "dynamic_rnn_mem_array_0"
    }
    outputs {
      parameter: "Out"
      arguments: "array_read_1.tmp_0"
    }
    type: "read_from_array"
  }
  ops {
    inputs {
      parameter: "I"
      arguments: "fill_constant_1.tmp_0"
    }
    inputs {
      parameter: "RankTable"
      arguments: "lod_rank_table_0"
    }
    inputs {
      parameter: "X"
      arguments: "array_read_1.tmp_0"
    }
    outputs {
      parameter: "Out"
      arguments: "shrink_memory_0.tmp_0"
    }
    type: "shrink_rnn_memory"
  }
  ops {
    inputs {
      parameter: "X"
      arguments: "array_read_0.tmp_0"
    }
    inputs {
      parameter: "Y"
      arguments: "fc_1.w_0"
    }
    outputs {
      parameter: "Out"
      arguments: "fc_1.tmp_0"
    }
    type: "mul"
    attrs {
      name: "y_num_col_dims"
      type: INT
      i: 1
    }
    attrs {
      name: "x_num_col_dims"
      type: INT
      i: 1
    }
  }
  ops {
    inputs {
      parameter: "X"
      arguments: "shrink_memory_0.tmp_0"
    }
    inputs {
      parameter: "Y"
      arguments: "fc_1.w_1"
    }
    outputs {
      parameter: "Out"
      arguments: "fc_1.tmp_1"
    }
    type: "mul"
    attrs {
      name: "y_num_col_dims"
      type: INT
      i: 1
    }
    attrs {
      name: "x_num_col_dims"
      type: INT
      i: 1
    }
  }
  ops {
    inputs {
      parameter: "X"
      arguments: "fc_1.tmp_0"
      arguments: "fc_1.tmp_1"
    }
    outputs {
      parameter: "Out"
      arguments: "fc_1.tmp_2"
    }
    type: "sum"
  }
  ops {
    inputs {
      parameter: "X"
      arguments: "fc_1.tmp_2"
    }
    inputs {
      parameter: "Y"
      arguments: "fc_1.b_0"
    }
    outputs {
      parameter: "Out"
      arguments: "fc_1.tmp_3"
    }
    type: "elementwise_add"
    attrs {
      name: "axis"
      type: INT
      i: 1
    }
  }
  ops {
    inputs {
      parameter: "X"
      arguments: "fc_1.tmp_3"
    }
    outputs {
      parameter: "Out"
      arguments: "fc_1.tmp_4"
    }
    type: "tanh"
  }
  ops {
    inputs {
      parameter: "X"
      arguments: "fc_1.tmp_4"
    }
    inputs {
      parameter: "Y"
      arguments: "fc_2.w_0"
    }
    outputs {
      parameter: "Out"
      arguments: "fc_2.tmp_0"
    }
    type: "mul"
    attrs {
      name: "y_num_col_dims"
      type: INT
      i: 1
    }
    attrs {
      name: "x_num_col_dims"
      type: INT
      i: 1
    }
  }
  ops {
    inputs {
      parameter: "X"
      arguments: "fc_2.tmp_0"
    }
    inputs {
      parameter: "Y"
      arguments: "fc_2.b_0"
    }
    outputs {
      parameter: "Out"
      arguments: "fc_2.tmp_1"
    }
    type: "elementwise_add"
    attrs {
      name: "axis"
      type: INT
      i: 1
    }
  }
  ops {
    inputs {
      parameter: "X"
      arguments: "fc_2.tmp_1"
    }
    outputs {
      parameter: "Out"
      arguments: "fc_2.tmp_2"
    }
    type: "softmax"
  }
  ops {
    inputs {
      parameter: "I"
      arguments: "fill_constant_1.tmp_0"
    }
    inputs {
      parameter: "X"
      arguments: "fc_2.tmp_2"
    }
    outputs {
      parameter: "Out"
      arguments: "dynamic_rnn_0_output_array_fc_2.tmp_2_0"
    }
    type: "write_to_array"
  }
  ops {
    inputs {
      parameter: "X"
      arguments: "fill_constant_1.tmp_0"
    }
    outputs {
      parameter: "Out"
      arguments: "fill_constant_1.tmp_0"
    }
    type: "increment"
    attrs {
      name: "step"
      type: FLOAT
      f: 1.0
    }
  }
  ops {
    inputs {
      parameter: "I"
      arguments: "fill_constant_1.tmp_0"
    }
    inputs {
      parameter: "X"
      arguments: "fc_1.tmp_4"
    }
    outputs {
      parameter: "Out"
      arguments: "dynamic_rnn_mem_array_0"
    }
    type: "write_to_array"
  }
  ops {
    inputs {
      parameter: "X"
      arguments: "fill_constant_1.tmp_0"
    }
    inputs {
      parameter: "Y"
      arguments: "dynamic_rnn_max_seq_len_0"
    }
    outputs {
      parameter: "Out"
      arguments: "dynamic_rnn_0.tmp_0"
    }
    type: "less_than"
  }
}
blocks {
  idx: 2
  parent_idx: 1
  vars {
    name: "fc_1.w_0@GRAD"
    type: LOD_TENSOR
    lod_tensor {
      tensor {
        data_type: FP32
        dims: 16
        dims: 32
      }
    }
  }
  vars {
    name: "fc_1.tmp_0@GRAD"
    type: LOD_TENSOR
    lod_tensor {
      tensor {
        data_type: FP32
        dims: -1
        dims: 32
      }
      lod_level: 0
    }
  }
  vars {
    name: "fc_1.tmp_3@GRAD"
    type: LOD_TENSOR
    lod_tensor {
      tensor {
        data_type: FP32
        dims: -1
        dims: 32
      }
    }
  }
  vars {
    name: "fc_1.tmp_4@GRAD"
    type: LOD_TENSOR
    lod_tensor {
      tensor {
        data_type: FP32
        dims: -1
        dims: 32
      }
      lod_level: 0
    }
  }
  vars {
    name: "fc_2.w_0@GRAD"
    type: LOD_TENSOR
    lod_tensor {
      tensor {
        data_type: FP32
        dims: 32
        dims: 30000
      }
    }
  }
  vars {
    name: "fc_1.tmp_4@GRAD@RENAME@1"
    type: LOD_TENSOR
    lod_tensor {
      tensor {
        data_type: FP32
        dims: -1
        dims: 32
      }
    }
  }
  vars {
    name: "fc_1.tmp_2@GRAD"
    type: LOD_TENSOR
    lod_tensor {
      tensor {
        data_type: FP32
        dims: -1
        dims: 32
      }
    }
  }
  vars {
    name: "fc_1.w_1@GRAD"
    type: LOD_TENSOR
    lod_tensor {
      tensor {
        data_type: FP32
        dims: 32
        dims: 32
      }
    }
  }
  vars {
    name: "fc_1.tmp_1@GRAD"
    type: LOD_TENSOR
    lod_tensor {
      tensor {
        data_type: FP32
        dims: -1
        dims: 32
      }
      lod_level: 0
    }
  }
  vars {
    name: "fc_2.b_0@GRAD"
    type: LOD_TENSOR
    lod_tensor {
      tensor {
        data_type: FP32
        dims: 30000
      }
    }
  }
  vars {
    name: "array_read_0.tmp_0@GRAD"
    type: LOD_TENSOR
    lod_tensor {
      tensor {
        data_type: FP32
        dims: -1
        dims: 16
      }
    }
  }
  vars {
    name: "fc_2.tmp_1@GRAD"
    type: LOD_TENSOR
    lod_tensor {
      tensor {
        data_type: FP32
        dims: -1
        dims: 30000
      }
    }
  }
  vars {
    name: "fc_2.tmp_2@GRAD"
    type: LOD_TENSOR
    lod_tensor {
      tensor {
        data_type: FP32
        dims: -1
        dims: 30000
      }
    }
  }
  vars {
    name: "array_read_1.tmp_0@GRAD"
    type: LOD_TENSOR
    lod_tensor {
      tensor {
        data_type: FP32
        dims: -1
        dims: 32
      }
      lod_level: 0
    }
  }
  vars {
    name: "shrink_memory_0.tmp_0@GRAD"
    type: LOD_TENSOR
    lod_tensor {
      tensor {
        data_type: FP32
        dims: -1
        dims: 32
      }
    }
  }
  vars {
    name: "fc_2.tmp_0@GRAD"
    type: LOD_TENSOR
    lod_tensor {
      tensor {
        data_type: FP32
        dims: -1
        dims: 30000
      }
    }
  }
  vars {
    name: "dynamic_rnn_mem_array_0@GRAD"
    type: LOD_TENSOR_ARRAY
    tensor_array {
      tensor {
        data_type: FP32
        dims: -1
        dims: 32
      }
    }
  }
  vars {
    name: "fc_1.b_0@GRAD"
    type: LOD_TENSOR
    lod_tensor {
      tensor {
        data_type: FP32
        dims: 32
      }
    }
  }
  vars {
    name: "dynamic_rnn_input_array_0@GRAD"
    type: LOD_TENSOR_ARRAY
    tensor_array {
      tensor {
        data_type: FP32
        dims: -1
        dims: 16
      }
    }
  }
  vars {
    name: "fc_1.tmp_4@GRAD@RENAME@0"
    type: LOD_TENSOR
    lod_tensor {
      tensor {
        data_type: FP32
      }
    }
  }
  ops {
    inputs {
      parameter: "I"
      arguments: "fill_constant_1.tmp_0"
    }
    inputs {
      parameter: "X"
      arguments: "dynamic_rnn_mem_array_0@GRAD"
    }
    outputs {
      parameter: "Out"
      arguments: "fc_1.tmp_4@GRAD@RENAME@0"
    }
    type: "read_from_array"
  }
  ops {
    inputs {
      parameter: "X"
      arguments: "fill_constant_1.tmp_0"
    }
    outputs {
      parameter: "Out"
      arguments: "fill_constant_1.tmp_0"
    }
    type: "increment"
    attrs {
      name: "step"
      type: FLOAT
      f: -1.0
    }
  }
  ops {
    inputs {
      parameter: "I"
      arguments: "fill_constant_1.tmp_0"
    }
    inputs {
      parameter: "X"
      arguments: "dynamic_rnn_0_output_array_fc_2.tmp_2_0@GRAD"
    }
    outputs {
      parameter: "Out"
      arguments: "fc_2.tmp_2@GRAD"
    }
    type: "read_from_array"
  }
  ops {
    inputs {
      parameter: "Out"
      arguments: "fc_2.tmp_2"
    }
    inputs {
      parameter: "Out@GRAD"
      arguments: "fc_2.tmp_2@GRAD"
    }
    inputs {
      parameter: "X"
      arguments: "fc_2.tmp_1"
    }
    outputs {
      parameter: "X@GRAD"
      arguments: "fc_2.tmp_1@GRAD"
    }
    type: "softmax_grad"
  }
  ops {
    inputs {
      parameter: "Out"
      arguments: "fc_2.tmp_1"
    }
    inputs {
      parameter: "Out@GRAD"
      arguments: "fc_2.tmp_1@GRAD"
    }
    inputs {
      parameter: "X"
      arguments: "fc_2.tmp_0"
    }
    inputs {
      parameter: "Y"
      arguments: "fc_2.b_0"
    }
    outputs {
      parameter: "X@GRAD"
      arguments: "fc_2.tmp_0@GRAD"
    }
    outputs {
      parameter: "Y@GRAD"
      arguments: "fc_2.b_0@GRAD"
    }
    type: "elementwise_add_grad"
    attrs {
      name: "axis"
      type: INT
      i: 1
    }
  }
  ops {
    inputs {
      parameter: "Out"
      arguments: "fc_2.tmp_0"
    }
    inputs {
      parameter: "Out@GRAD"
      arguments: "fc_2.tmp_0@GRAD"
    }
    inputs {
      parameter: "X"
      arguments: "fc_1.tmp_4"
    }
    inputs {
      parameter: "Y"
      arguments: "fc_2.w_0"
    }
    outputs {
      parameter: "X@GRAD"
      arguments: "fc_1.tmp_4@GRAD@RENAME@1"
    }
    outputs {
      parameter: "Y@GRAD"
      arguments: "fc_2.w_0@GRAD"
    }
    type: "mul_grad"
    attrs {
      name: "y_num_col_dims"
      type: INT
      i: 1
    }
    attrs {
      name: "x_num_col_dims"
      type: INT
      i: 1
    }
  }
  ops {
    inputs {
      parameter: "X"
      arguments: "fc_1.tmp_4@GRAD@RENAME@0"
      arguments: "fc_1.tmp_4@GRAD@RENAME@1"
    }
    outputs {
      parameter: "Out"
      arguments: "fc_1.tmp_4@GRAD"
    }
    type: "sum"
  }
  ops {
    inputs {
      parameter: "Out"
      arguments: "fc_1.tmp_4"
    }
    inputs {
      parameter: "Out@GRAD"
      arguments: "fc_1.tmp_4@GRAD"
    }
    inputs {
      parameter: "X"
      arguments: "fc_1.tmp_3"
    }
    outputs {
      parameter: "X@GRAD"
      arguments: "fc_1.tmp_3@GRAD"
    }
    type: "tanh_grad"
  }
  ops {
    inputs {
      parameter: "Out"
      arguments: "fc_1.tmp_3"
    }
    inputs {
      parameter: "Out@GRAD"
      arguments: "fc_1.tmp_3@GRAD"
    }
    inputs {
      parameter: "X"
      arguments: "fc_1.tmp_2"
    }
    inputs {
      parameter: "Y"
      arguments: "fc_1.b_0"
    }
    outputs {
      parameter: "X@GRAD"
      arguments: "fc_1.tmp_2@GRAD"
    }
    outputs {
      parameter: "Y@GRAD"
      arguments: "fc_1.b_0@GRAD"
    }
    type: "elementwise_add_grad"
    attrs {
      name: "axis"
      type: INT
      i: 1
    }
  }
  ops {
    inputs {
      parameter: "X"
      arguments: "fc_1.tmp_2@GRAD"
    }
    outputs {
      parameter: "Out"
      arguments: "fc_1.tmp_0@GRAD"
    }
    type: "scale"
    attrs {
      name: "scale"
      type: FLOAT
      f: 1.0
    }
  }
  ops {
    inputs {
      parameter: "X"
      arguments: "fc_1.tmp_2@GRAD"
    }
    outputs {
      parameter: "Out"
      arguments: "fc_1.tmp_1@GRAD"
    }
    type: "scale"
    attrs {
      name: "scale"
      type: FLOAT
      f: 1.0
    }
  }
  ops {
    inputs {
      parameter: "Out"
      arguments: "fc_1.tmp_1"
    }
    inputs {
      parameter: "Out@GRAD"
      arguments: "fc_1.tmp_1@GRAD"
    }
    inputs {
      parameter: "X"
      arguments: "shrink_memory_0.tmp_0"
    }
    inputs {
      parameter: "Y"
      arguments: "fc_1.w_1"
    }
    outputs {
      parameter: "X@GRAD"
      arguments: "shrink_memory_0.tmp_0@GRAD"
    }
    outputs {
      parameter: "Y@GRAD"
      arguments: "fc_1.w_1@GRAD"
    }
    type: "mul_grad"
    attrs {
      name: "y_num_col_dims"
      type: INT
      i: 1
    }
    attrs {
      name: "x_num_col_dims"
      type: INT
      i: 1
    }
  }
  ops {
    inputs {
      parameter: "Out"
      arguments: "fc_1.tmp_0"
    }
    inputs {
      parameter: "Out@GRAD"
      arguments: "fc_1.tmp_0@GRAD"
    }
    inputs {
      parameter: "X"
      arguments: "array_read_0.tmp_0"
    }
    inputs {
      parameter: "Y"
      arguments: "fc_1.w_0"
    }
    outputs {
      parameter: "X@GRAD"
      arguments: "array_read_0.tmp_0@GRAD"
    }
    outputs {
      parameter: "Y@GRAD"
      arguments: "fc_1.w_0@GRAD"
    }
    type: "mul_grad"
    attrs {
      name: "y_num_col_dims"
      type: INT
      i: 1
    }
    attrs {
      name: "x_num_col_dims"
      type: INT
      i: 1
    }
  }
  ops {
    inputs {
      parameter: "Out@GRAD"
      arguments: "shrink_memory_0.tmp_0@GRAD"
    }
    inputs {
      parameter: "X"
      arguments: "array_read_1.tmp_0"
    }
    outputs {
      parameter: "X@GRAD"
      arguments: "array_read_1.tmp_0@GRAD"
    }
    type: "shrink_rnn_memory_grad"
  }
  ops {
    inputs {
      parameter: "I"
      arguments: "fill_constant_1.tmp_0"
    }
    inputs {
      parameter: "X"
      arguments: "array_read_1.tmp_0@GRAD"
    }
    outputs {
      parameter: "Out"
      arguments: "dynamic_rnn_mem_array_0@GRAD"
    }
    type: "write_to_array"
  }
  ops {
    inputs {
      parameter: "I"
      arguments: "fill_constant_1.tmp_0"
    }
    inputs {
      parameter: "X"
      arguments: "array_read_0.tmp_0@GRAD"
    }
    outputs {
      parameter: "Out"
      arguments: "dynamic_rnn_input_array_0@GRAD"
    }
    type: "write_to_array"
  }
}
